# Carwash CRM — описание программы

Веб-приложение для автомойки: публичное онлайн-бронирование и две закрытые зоны — **панель владельца (админка)** и **панель сотрудника**. Интерфейс на немецком языке.

---

## Общая схема

- **Публичная часть** — клиент выбирает услугу, дату, время, вводит контакты и создаёт бронь. На e-mail приходит подтверждение со ссылкой для отмены.
- **Владелец (Inhaber)** — полный доступ: аналитика, услуги, сотрудники, все брони, настройки, экспорт, смена пароля.
- **Сотрудник (Mitarbeiter)** — просмотр своих бронирований на неделю и создание «ручных» записей (Walk-In).

Роли различаются после входа: владелец попадает в админку (`/owner`), сотрудник — в панель сотрудника (`/worker`).

---

## Админка (панель владельца)

Вход: **owner** + пароль (задаётся через переменную окружения при первом создании). После входа доступно боковое меню и пять разделов.

### 1. Dashboard (`/owner`)

- **Сводные показатели (карточки):**
  - Umsatz heute — выручка за сегодня
  - Umsatz diesen Monat — выручка за текущий месяц
  - Ø Einnahmen pro Termin — средний чек
  - Erledigte Termine — количество завершённых бронирований
  - Alle Termine (gesamt) — всего бронирований
  - Stornoquote — доля отмен (в %)
- **Графики:**
  - Umsatz nach Mitarbeiter — столбчатая диаграмма выручки по сотрудникам
  - Umsatz nach Quelle — круговая диаграмма выручки по источникам (Website, Mitarbeiter, Telefon)
- **Блок:** Beliebtester Service — самый часто заказываемый сервис

Данные считаются по завершённым бронированиям.

---

### 2. Services (`/owner/services`)

- **Список услуг** — название, цена, длительность (мин), описание.
- **Действия:**
  - Создать услугу (+ Service erstellen) — модальное окно: название, цена, длительность, описание.
  - Редактировать — кнопка у каждой услуги, те же поля.
  - Удалить — с подтверждением.
- Эти же услуги отображаются на публичной странице бронирования и в панели сотрудника при создании записи.

---

### 3. Mitarbeiter (`/owner/workers`)

- **Список сотрудников** — логин (username), при необходимости рабочие часы и дни (если доработаны в бэкенде).
- **Действия:**
  - Создать сотрудника — логин и пароль. После создания сотрудник может входить в панель Mitarbeiter.
  - Редактировать — изменить логин/пароль.
  - Удалить — с подтверждением.
- Сотрудники используются в фильтрах и в аналитике (выручка по сотруднику).

---

### 4. Termine (`/owner/schedule`)

- **Календарь бронирований по неделям** — переключение недель (стрелки, «Сегодня»).
- **Фильтр по сотруднику** — выбор сотрудника, отображение только его бронирований (если привязано к брони).
- **По дням недели** — карточки с бронированиями на каждый день: клиент, услуга, время, статус.
- **Действия по бронированию:**
  - Stornieren — отмена брони (статус отмены).
  - При необходимости — перенос времени (если реализовано в интерфейсе).
- Отображаются активные брони (без отменённых или с отдельной пометкой), чтобы владелец видел актуальную сетку.

---

### 5. Einstellungen (`/owner/settings`)

- **Öffnungszeiten:**
  - Arbeitsbeginn / Arbeitsende — время начала и окончания рабочего дня (для слотов на сайте и в календаре).
- **Arbeitstage:** выбор дней недели (Mo–So), когда мойка принимает брони.
- **Кнопка «Speichern»** — сохранение настроек; они используются при расчёте доступных слотов на публичной странице и в логике бронирований.
- **Passwort ändern (блок ниже):**
  - Текущий пароль, новый пароль, подтверждение.
  - Рекомендуется сменить пароль после первого входа (пароль больше не хранится в коде, задаётся при деплое через переменную окружения).

---

### Дополнительно в админке (бэкенд/экспорт)

- **Экспорт в Excel** — по API: выгрузка завершённых бронирований за выбранный период (дата начала и конца) в формате `.xlsx` (колонки: Datum, Uhrzeit, Kunde, Telefon, Dienstleistung, Preis, Quelle). Вызов через endpoint (например, из кнопки или отдельной страницы, если она добавлена во фронт).

Итого по админке: один вход (owner), пять разделов (Dashboard, Services, Mitarbeiter, Termine, Einstellungen) и возможность экспорта и смены пароля.

---

## Панель сотрудника (кратко)

- Вход: логин и пароль сотрудника, созданного владельцем.
- **Недельный вид бронирований** — свои (или общие) записи с возможностью отмечать «Erledigt» и «Stornieren».
- **Создание записи вручную** — выбор даты, времени, услуги, имя клиента (например, Walk-In); запись сохраняется как бронирование с источником «worker».

---

## Публичная часть (кратко)

- Главная страница — пошаговое бронирование: выбор услуги → дата → время (слоты по настройкам мойки) → контакты (имя, телефон, e-mail) → подтверждение.
- После отправки — переход на страницу успеха и (при настроенной почте) письмо с подтверждением и ссылкой на отмену.
- Ссылка отмены ведёт на страницу вида `/cancel/:token` — отмена брони и сообщение «Termin storniert».

---

## Технологии

- **Backend:** FastAPI (Python), SQLite/PostgreSQL, JWT-авторизация.
- **Frontend:** React (Vite), React Router, axios.
- **Деплой:** например, Render (backend + static site + БД); переменные окружения задаются в панели Render.

Это описание можно использовать как основу для README, техзадания или инструкции для владельца мойки.
